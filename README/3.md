商品相关
---

### 商品类型管理

- 增删查改功能
- 数据库字段
    * title 类型名称
    * description 类型描述
    * status 类型状态
    * add_time 添加时间
- 增加商品选择 `规格与包装` 时候，需要选择商品类型
- 商品类型的属性
    * 增删查改功能
    * 数据库字段
        * cate_id 分类id
        * title 类型属性名称
        * attr_type 属性类型 1 input 2 textarea 3 select
        * attr_value 默认值 input textarea默认值是空 select框有默认值 多个默认值以回车隔开
        * status 属性状态
        * add_time 添加时间
- 每个商品类型有格子的类型属性，如手机有：内存，cpu 等属性

### 商品分类管理

- 首页或列表页面通用的商品分类
- 增删查改功能
- 上传图片(生成缩略图)功能
- 数据库字段
    * title 分类名称
    * cate_img 分类图片
    * filter_attr 筛选id
    * link 分类连接
    * template 分类的模板
    * pid: 分类id，自关联表 type: Schema.Types.Mixed 混合类型 一般String和ObjectId 混用时，使用这个类型
    * sub_title 副标题
    * keywords seo 相关的标题 关键词
    * description 描述
    * status 状态
    * add_time 创建时间

**生成缩略图**

- 安装jimp: cnpm i --save jimp
- 使用jimp模块

```js
const Jimp = require('jimp');

//生成缩略图的公共方法
async jimpImg(target) {
    //上传图片成功以后生成缩略图
    Jimp.read(target, (err, lenna) => {
        if (err) throw err;
        for (let i = 0; i < this.config.jimpSize.length; i++) {
            let w = this.config.jimpSize[i].width;
            let h = this.config.jimpSize[i].height;
            let extname = path.extname(target); // 获取后缀名
            let picPath = target.substr(0, target.indexOf(extname)) + '_' + w + 'x' + h + extname; // 重新拼接
            lenna.resize(w, h) // resize
                .quality(90) // set JPEG quality
                .write(picPath);
        }
    });
}
```